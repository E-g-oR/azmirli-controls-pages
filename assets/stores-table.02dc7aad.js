var oe=Object.defineProperty,ne=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var Q=(u,e,n)=>e in u?oe(u,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[e]=n,f=(u,e)=>{for(var n in e||(e={}))ie.call(e,n)&&Q(u,n,e[n]);if(H)for(var n of H(e))ce.call(e,n)&&Q(u,n,e[n]);return u},k=(u,e)=>ne(u,ae(e));import{s as le,r as p,c as de,M as me,a as pe,j as r,_ as ee,ah as U,ai as L,aj as ge,ak as he,al as Ce,am as xe,L as fe,$ as ue,a0 as z,aG as ye,aF as be,p as C,B as h,b1 as ke,b2 as Ee,au as $,a1 as Be,az as Te,n as ve,aO as De,aM as Fe}from"./index.b236c2eb.js";import{u as Se,c as we,e as q,C as v,T as F,h as Ie,S as Oe,E as Ne,D as je,g as Ae,a as Re,F as Ve,i as Me,j as qe,b as ze}from"./index.f293bfe2.js";import{m as re}from"./cities-dialog.5942a1de.js";import{S as X,O as Y}from"./Option.34a029d2.js";import{T as J,I as K}from"./IconButton.761031d4.js";import{T as Z}from"./Typography.9c4c5905.js";import"./ListItemButton.c68afcec.js";const Pe=["component","direction","spacing","divider","children"];function Le(u,e){const n=p.exports.Children.toArray(u).filter(Boolean);return n.reduce((i,m,l)=>(i.push(m),l<n.length-1&&i.push(p.exports.cloneElement(e,{key:`separator-${l}`})),i),[])}const We=u=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[u],$e=({ownerState:u,theme:e})=>{let n=ee({display:"flex",flexDirection:"column"},U({theme:e},L({values:u.direction,breakpoints:e.breakpoints.values}),i=>({flexDirection:i})));if(u.spacing){const i=ge(e),m=Object.keys(e.breakpoints.values).reduce((s,d)=>((typeof u.spacing=="object"&&u.spacing[d]!=null||typeof u.direction=="object"&&u.direction[d]!=null)&&(s[d]=!0),s),{}),l=L({values:u.direction,base:m}),g=L({values:u.spacing,base:m});typeof l=="object"&&Object.keys(l).forEach((s,d,x)=>{if(!l[s]){const w=d>0?l[x[d-1]]:"column";l[s]=w}}),n=he(n,U({theme:e},g,(s,d)=>({"& > :not(style) + :not(style)":{margin:0,[`margin${We(d?l[d]:u.direction)}`]:xe(i,s)}})))}return n=Ce(e.breakpoints,n),n},_e=le("div",{name:"MuiStack",slot:"Root",overridesResolver:(u,e)=>[e.root]})($e),Ge=p.exports.forwardRef(function(e,n){const i=de({props:e,name:"MuiStack"}),m=me(i),{component:l="div",direction:g="column",spacing:B=0,divider:s,children:d}=m,x=pe(m,Pe);return r(_e,ee({as:l,ownerState:{direction:g,spacing:B},ref:n},x,{children:s?Le(d,s):d}))});var W=Ge;const E=fe(u=>({isOpen:!1,mode:"create",stores:null,currentStore:null,setIsOpen:e=>u({isOpen:e}),setStores:e=>u({stores:e}),setMode:e=>u({mode:e}),setCurrentStore:e=>u({currentStore:e,mode:"edit"}),clearCurrentStore:()=>u({currentStore:null,mode:"create"})})),He=u=>()=>be("stores",u),Qe=u=>()=>ye("stores",u.id,u),P=["\u0443\u043B\u0438\u0446\u0430","\u043F\u0435\u0440\u0435\u0443\u043B\u043E\u043A","\u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442"],y={cityName:"",building:"",comment:"",streetName:"",streetType:P[0],workingTimeStart:"9",workingTimeEnd:"21"},Ue=()=>{const{enqueueSnackbar:u}=ue(),{control:e,handleSubmit:n,setValue:i,reset:m,clearErrors:l}=Se({defaultValues:y}),g=E(t=>t.mode),B=E(t=>t.isOpen),s=E(t=>t.currentStore),d=E(t=>t.setIsOpen),x=E(t=>t.clearCurrentStore),S=z(t=>t.getCityById),w=z(t=>t.getCityByName),I=z(t=>t.cities),N=p.exports.useCallback(()=>{m(y),l()},[m,l]),o=()=>{N(),d(!1),x()};p.exports.useEffect(()=>{var t,a,c,j,A,R,V,M,O;i("streetType",(t=s==null?void 0:s.streetType)!=null?t:y.streetType),i("streetName",(a=s==null?void 0:s.streetName)!=null?a:y.streetName),i("building",(c=s==null?void 0:s.building)!=null?c:y.building),i("comment",(j=s==null?void 0:s.comment)!=null?j:y.comment),i("workingTimeStart",(A=s==null?void 0:s.workingTimeStart)!=null?A:y.workingTimeStart),i("workingTimeEnd",(R=s==null?void 0:s.workingTimeEnd)!=null?R:y.workingTimeEnd),i("cityName",(O=(M=S((V=s==null?void 0:s.cityId)!=null?V:""))==null?void 0:M.name)!=null?O:y.cityName)},[s]);const T=()=>{u("Success",{variant:"success"}),o(),N()},b=()=>{u("Something went wrong",{variant:"error"})},D=p.exports.useMemo(()=>`${g==="create"?"\u0421\u043E\u0437\u0434\u0430\u0442\u044C":"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"} \u043C\u0430\u0433\u0430\u0437\u0438\u043D`,[g]),se=p.exports.useCallback(t=>{var _,G;const{workingTimeEnd:a,workingTimeStart:c,comment:j,building:A,streetType:R,streetName:V,cityName:M}=t,O={workingTimeStart:c,workingTimeEnd:a,comment:j,building:A,streetType:R,streetName:V,cityId:(G=(_=w(M))==null?void 0:_.id)!=null?G:""},te=g==="edit"&&s?Qe(f(f({},s),O)):He(O);return re(te,T,b)},[g,s,T,b]);return C(we,{isOpen:B,onClose:o,onCancel:o,onSubmit:n(se),title:D,children:[r(q,{children:"\u0410\u0434\u0440\u0435\u0441"}),r(v,{control:e,name:"cityName",render:({field:t})=>C(h,{children:[r(q,{children:"\u0413\u043E\u0440\u043E\u0434"}),r(X,k(f({variant:"soft"},t),{componentsProps:{listbox:{sx:{maxHeight:240,overflow:"auto","--List-padding":"0px"}}},children:I==null?void 0:I.map(a=>r(Y,{value:a.name,children:a.name},a.id))}))]})}),C(W,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2},alignItems:{xs:"stretch",sm:"flex-end"},children:[r(v,{control:e,name:"streetType",render:({field:t})=>C(h,{sx:{width:{xs:"100%",sm:130},minWidth:{xs:"100%",sm:130},maxWidth:{xs:"100%",sm:130}},children:[r(q,{children:"\u0422\u0438\u043F \u0443\u043B\u0438\u0446\u044B"}),r(X,k(f({variant:"soft"},t),{componentsProps:{listbox:{sx:{maxHeight:240,overflow:"auto","--List-padding":"0px"}}},children:P==null?void 0:P.map(a=>r(Y,{value:a,children:a},a))}))]})}),r(v,{name:"streetName",rules:{required:{message:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0443\u043B\u0438\u0446\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},control:e,render:({field:t,fieldState:a})=>{var c;return r(F,k(f({label:"\u0423\u043B\u0438\u0446\u0430",variant:"soft",fullWidth:!0},t),{error:!!a.error,helperText:(c=a.error)==null?void 0:c.message}))}}),r(v,{name:"building",rules:{required:{message:"\u041D\u043E\u043C\u0435\u0440 \u0437\u0434\u0430\u043D\u0438\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},control:e,render:({field:t,fieldState:a})=>{var c;return r(h,{sx:{width:{xs:"100%",sm:100}},children:r(F,k(f({label:"\u0417\u0434\u0430\u043D\u0438\u0435",variant:"soft"},t),{error:!!a.error,helperText:(c=a.error)==null?void 0:c.message}))})}})]}),r(v,{name:"comment",control:e,render:({field:t,fieldState:a})=>{var c;return r(F,k(f({label:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",variant:"soft",fullWidth:!0},t),{error:!!a.error,helperText:(c=a.error)==null?void 0:c.message}))}}),C(W,{direction:"column",children:[r(q,{sx:{marginTop:1},children:"\u0420\u0430\u0431\u043E\u0447\u0435\u0435 \u0432\u0440\u0435\u043C\u044F:"}),C(W,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2},children:[r(v,{name:"workingTimeStart",control:e,rules:{required:{message:"\u0412\u0440\u0435\u043C\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},render:({field:t,fieldState:a})=>{var c;return r(F,k(f({label:"\u041D\u0430\u0447\u0430\u043B\u043E",variant:"soft"},t),{error:!!a.error,helperText:(c=a.error)==null?void 0:c.message}))}}),r(v,{name:"workingTimeEnd",control:e,rules:{required:{message:"\u0412\u0440\u0435\u043C\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},render:({field:t,fieldState:a})=>{var c;return r(F,k(f({label:"\u041A\u043E\u043D\u0435\u0446",variant:"soft"},t),{error:!!a.error,helperText:(c=a.error)==null?void 0:c.message}))}})]})]})]})},Xe=u=>()=>Be("stores",u),Ye=u=>$(u,Fe(({cityId:e})=>e)),ou=()=>{const{isTableResponsive:u}=Ie(),e=p.exports.useRef(null),n=E(o=>o.setMode),i=E(o=>o.setIsOpen),m=z(o=>o.getCityById),l=E(o=>o.setCurrentStore),{enqueueSnackbar:g}=ue(),[B,s]=p.exports.useState(""),d=p.exports.useCallback(o=>{n("edit"),l(o),i(!0)},[n,l]),x=ke(Ee("stores")),S=p.exports.useMemo(()=>$(x!=null?x:[],Me(B),Ye),[x,B]),w=()=>{g("\u0410\u0440\u043E\u043C\u0430\u0442 \u0431\u044B\u043B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D.",{variant:"success"})},I=()=>{g("\u041D\u0435 \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0440\u043E\u043C\u0430\u0442 ://",{variant:"error"})},N=p.exports.useMemo(()=>[{key:"actions",header:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",size:"100px",render:o=>C(Oe,{direction:"row",spacing:1,children:[r(J,{title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",children:r(K,{variant:"plain",onClick:()=>d(o),children:r(Ne,{})})}),r(J,{title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",children:r(K,{variant:"plain",onClick:()=>re(Xe(o.id),w,I),children:r(je,{})})})]})},{key:"address",header:"\u0410\u0434\u0440\u0435\u0441",size:"200px",render:o=>C(h,{children:["\u0443\u043B. ",o.streetName,", \u0434. ",o.building]})},{key:"workingTime",header:"\u0432\u0440\u0435\u043C\u044F \u0440\u0430\u0431\u043E\u0442\u044B",size:"150px",render:o=>C(h,{children:[o.workingTimeStart,":",o.workingTimeEnd]})},{key:"comment",header:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",size:"minmax(200px, 1fr)",render:o=>r(h,{children:o.comment})}],[m,d]);return p.exports.useEffect(()=>{var b;let o;const T=(b=e==null?void 0:e.current)==null?void 0:b.querySelector("input");return T&&(o=Ae(T,s)),()=>o.unsubscribe()},[e]),C(h,{children:[r(Z,{level:"h3",component:"h1",marginBottom:2,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 \u043C\u0430\u0433\u0430\u0437\u0438\u043D\u043E\u0432"}),r(h,{maxWidth:320,marginBottom:2,children:r(F,{ref:e,label:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u043C\u0430\u0433\u0430\u0437\u0438\u043D\u0430\u043C",placeholder:"\u041C\u0438\u043D\u0441\u043A\u0430\u044F"})}),r(h,{children:r(Re,{config:N,loading:!1,gap:2,children:$(S,De,Te(([o,T])=>{var b;return C(h,{children:[r(ve,{variant:"soft",sx:{position:"sticky",top:u?0:50,marginTop:3,paddingX:1,paddingY:.5,zIndex:5,borderRadius:D=>D.radius.sm},children:r(Z,{fontSize:"large",fontWeight:"bold",textTransform:"capitalize",children:(b=m(o))==null?void 0:b.name})}),r(h,{sx:{display:"grid",gridTemplateColumns:{lg:"1fr",md:qe.gridTemplateColumns},gap:2},children:T.map(D=>r(ze,{row:D},D.id))})]},o)}))})}),r(Ue,{}),r(Ve,{onClick:()=>{n("create"),i(!0)}})]})};export{ou as default};
