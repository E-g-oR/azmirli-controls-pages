var oe=Object.defineProperty,ne=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var H=(e,u,i)=>u in e?oe(e,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[u]=i,h=(e,u)=>{for(var i in u||(u={}))ae.call(u,i)&&H(e,i,u[i]);if(_)for(var i of _(u))ce.call(u,i)&&H(e,i,u[i]);return e},y=(e,u)=>ne(e,ie(u));import{s as le,r as x,c as de,L as me,a as pe,j as s,_ as J,a2 as X,a3 as q,a4 as ge,a5 as he,a6 as xe,a7 as Ce,K as fe,V as Z,W as j,ai as ye,ah as ke,v as g,B as f,aM as Be,aN as Ee,ap as ee,X as Te,as as ve,ar as be,n as De,av as Fe}from"./index.605d8d15.js";import{u as Se,b as we,d as R,C as T,c as S,S as Ie,E as Ne,D as Oe,T as Ve,F as Re,a as je}from"./index.a8396a18.js";import{m as ue}from"./cities-dialog.2da998fc.js";import{S as G,O as K}from"./Option.5704027a.js";import{T as Q,I as U}from"./IconButton.85079b70.js";import{T as Y}from"./Typography.770c5cb5.js";import"./ListItemButton.ec83ece1.js";const Ae=["component","direction","spacing","divider","children"];function Me(e,u){const i=x.exports.Children.toArray(e).filter(Boolean);return i.reduce((a,m,l)=>(a.push(m),l<i.length-1&&a.push(x.exports.cloneElement(u,{key:`separator-${l}`})),a),[])}const qe=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],Pe=({ownerState:e,theme:u})=>{let i=J({display:"flex",flexDirection:"column"},X({theme:u},q({values:e.direction,breakpoints:u.breakpoints.values}),a=>({flexDirection:a})));if(e.spacing){const a=ge(u),m=Object.keys(u.breakpoints.values).reduce((r,d)=>((typeof e.spacing=="object"&&e.spacing[d]!=null||typeof e.direction=="object"&&e.direction[d]!=null)&&(r[d]=!0),r),{}),l=q({values:e.direction,base:m}),p=q({values:e.spacing,base:m});typeof l=="object"&&Object.keys(l).forEach((r,d,B)=>{if(!l[r]){const D=d>0?l[B[d-1]]:"column";l[r]=D}}),i=he(i,X({theme:u},p,(r,d)=>({"& > :not(style) + :not(style)":{margin:0,[`margin${qe(d?l[d]:e.direction)}`]:Ce(a,r)}})))}return i=xe(u.breakpoints,i),i},We=le("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,u)=>[u.root]})(Pe),ze=x.exports.forwardRef(function(u,i){const a=de({props:u,name:"MuiStack"}),m=me(a),{component:l="div",direction:p="column",spacing:v=0,divider:r,children:d}=m,B=pe(m,Ae);return s(We,J({as:l,ownerState:{direction:p,spacing:v},ref:i},B,{children:r?Me(d,r):d}))});var P=ze;const k=fe(e=>({isOpen:!1,mode:"create",stores:null,currentStore:null,setIsOpen:u=>e({isOpen:u}),setStores:u=>e({stores:u}),setMode:u=>e({mode:u}),setCurrentStore:u=>e({currentStore:u,mode:"edit"}),clearCurrentStore:()=>e({currentStore:null,mode:"create"})})),Le=e=>()=>ke("stores",e),$e=e=>()=>ye("stores",e.id,e),A=["\u0443\u043B\u0438\u0446\u0430","\u043F\u0435\u0440\u0435\u0443\u043B\u043E\u043A","\u043F\u0440\u043E\u0441\u043F\u0435\u043A\u0442"],C={cityName:"",building:"",comment:"",streetName:"",streetType:A[0],workingTimeStart:"9",workingTimeEnd:"21"},_e=()=>{const{enqueueSnackbar:e}=Z(),{control:u,handleSubmit:i,setValue:a,reset:m,clearErrors:l}=Se({defaultValues:C}),p=k(t=>t.mode),v=k(t=>t.isOpen),r=k(t=>t.currentStore),d=k(t=>t.setIsOpen),B=k(t=>t.clearCurrentStore),o=j(t=>t.getCityById),D=j(t=>t.getCityByName),b=j(t=>t.cities),E=x.exports.useCallback(()=>{m(C),l()},[m,l]),M=()=>{E(),d(!1),B()};x.exports.useEffect(()=>{var t,n,c,w,I,N,O,V,F;a("streetType",(t=r==null?void 0:r.streetType)!=null?t:C.streetType),a("streetName",(n=r==null?void 0:r.streetName)!=null?n:C.streetName),a("building",(c=r==null?void 0:r.building)!=null?c:C.building),a("comment",(w=r==null?void 0:r.comment)!=null?w:C.comment),a("workingTimeStart",(I=r==null?void 0:r.workingTimeStart)!=null?I:C.workingTimeStart),a("workingTimeEnd",(N=r==null?void 0:r.workingTimeEnd)!=null?N:C.workingTimeEnd),a("cityName",(F=(V=o((O=r==null?void 0:r.cityId)!=null?O:""))==null?void 0:V.name)!=null?F:C.cityName)},[r]);const W=()=>{e("Success",{variant:"success"}),M(),E()},z=()=>{e("Something went wrong",{variant:"error"})},re=x.exports.useMemo(()=>`${p==="create"?"\u0421\u043E\u0437\u0434\u0430\u0442\u044C":"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"} \u043C\u0430\u0433\u0430\u0437\u0438\u043D`,[p]),se=x.exports.useCallback(t=>{var L,$;const{workingTimeEnd:n,workingTimeStart:c,comment:w,building:I,streetType:N,streetName:O,cityName:V}=t,F={workingTimeStart:c,workingTimeEnd:n,comment:w,building:I,streetType:N,streetName:O,cityId:($=(L=D(V))==null?void 0:L.id)!=null?$:""},te=p==="edit"&&r?$e(h(h({},r),F)):Le(F);return ue(te,W,z)},[p,r,W,z]);return g(we,{isOpen:v,onClose:M,onCancel:M,onSubmit:i(se),title:re,children:[s(R,{children:"\u0410\u0434\u0440\u0435\u0441"}),s(T,{control:u,name:"cityName",render:({field:t})=>g(f,{children:[s(R,{children:"\u0413\u043E\u0440\u043E\u0434"}),s(G,y(h({variant:"soft"},t),{componentsProps:{listbox:{sx:{maxHeight:240,overflow:"auto","--List-padding":"0px"}}},children:b==null?void 0:b.map(n=>s(K,{value:n.name,children:n.name},n.id))}))]})}),g(P,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2},alignItems:{xs:"stretch",sm:"flex-end"},children:[s(T,{control:u,name:"streetType",render:({field:t})=>g(f,{sx:{width:{xs:"100%",sm:130},minWidth:{xs:"100%",sm:130},maxWidth:{xs:"100%",sm:130}},children:[s(R,{children:"\u0422\u0438\u043F \u0443\u043B\u0438\u0446\u044B"}),s(G,y(h({variant:"soft"},t),{componentsProps:{listbox:{sx:{maxHeight:240,overflow:"auto","--List-padding":"0px"}}},children:A==null?void 0:A.map(n=>s(K,{value:n,children:n},n))}))]})}),s(T,{name:"streetName",rules:{required:{message:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0443\u043B\u0438\u0446\u044B \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},control:u,render:({field:t,fieldState:n})=>{var c;return s(S,y(h({label:"\u0423\u043B\u0438\u0446\u0430",variant:"soft",fullWidth:!0},t),{error:!!n.error,helperText:(c=n.error)==null?void 0:c.message}))}}),s(T,{name:"building",rules:{required:{message:"\u041D\u043E\u043C\u0435\u0440 \u0437\u0434\u0430\u043D\u0438\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},control:u,render:({field:t,fieldState:n})=>{var c;return s(f,{sx:{width:{xs:"100%",sm:100}},children:s(S,y(h({label:"\u0417\u0434\u0430\u043D\u0438\u0435",variant:"soft"},t),{error:!!n.error,helperText:(c=n.error)==null?void 0:c.message}))})}})]}),s(T,{name:"comment",control:u,render:({field:t,fieldState:n})=>{var c;return s(S,y(h({label:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",variant:"soft",fullWidth:!0},t),{error:!!n.error,helperText:(c=n.error)==null?void 0:c.message}))}}),g(P,{direction:"column",children:[s(R,{sx:{marginTop:1},children:"\u0420\u0430\u0431\u043E\u0447\u0435\u0435 \u0432\u0440\u0435\u043C\u044F:"}),g(P,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2},children:[s(T,{name:"workingTimeStart",control:u,rules:{required:{message:"\u0412\u0440\u0435\u043C\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},render:({field:t,fieldState:n})=>{var c;return s(S,y(h({label:"\u041D\u0430\u0447\u0430\u043B\u043E",variant:"soft"},t),{error:!!n.error,helperText:(c=n.error)==null?void 0:c.message}))}}),s(T,{name:"workingTimeEnd",control:u,rules:{required:{message:"\u0412\u0440\u0435\u043C\u044F \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043F\u0443\u0441\u0442\u044B\u043C",value:!0}},render:({field:t,fieldState:n})=>{var c;return s(S,y(h({label:"\u041A\u043E\u043D\u0435\u0446",variant:"soft"},t),{error:!!n.error,helperText:(c=n.error)==null?void 0:c.message}))}})]})]})]})},He=e=>()=>Te("stores",e),Xe=e=>ee(e,ve(({cityId:u})=>u)),uu=()=>{const e=k(o=>o.setMode),u=k(o=>o.setIsOpen),i=j(o=>o.getCityById),a=k(o=>o.setCurrentStore),{enqueueSnackbar:m}=Z(),l=x.exports.useCallback(o=>{e("edit"),a(o),u(!0)},[e,a]),p=Be(Ee("stores")),v=x.exports.useMemo(()=>Xe(p!=null?p:[]),[p]),r=()=>{m("\u0410\u0440\u043E\u043C\u0430\u0442 \u0431\u044B\u043B \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D.",{variant:"success"})},d=()=>{m("\u041D\u0435 \u043F\u043E\u043B\u0443\u0447\u0438\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0430\u0440\u043E\u043C\u0430\u0442 ://",{variant:"error"})},B=x.exports.useMemo(()=>[{key:"actions",header:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",size:"100px",render:o=>g(Ie,{direction:"row",spacing:1,children:[s(Q,{title:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C",children:s(U,{variant:"plain",onClick:()=>l(o),children:s(Ne,{})})}),s(Q,{title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",children:s(U,{variant:"plain",onClick:()=>ue(He(o.id),r,d),children:s(Oe,{})})})]})},{key:"address",header:"\u0410\u0434\u0440\u0435\u0441",size:"200px",render:o=>g(f,{children:["\u0443\u043B. ",o.streetName,", \u0434. ",o.building]})},{key:"workingTime",header:"\u0432\u0440\u0435\u043C\u044F \u0440\u0430\u0431\u043E\u0442\u044B",size:"150px",render:o=>g(f,{children:[o.workingTimeStart,":",o.workingTimeEnd]})},{key:"comment",header:"\u041A\u043E\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",size:"minmax(200px, 1fr)",render:o=>s(f,{children:o.comment})}],[i,l]);return g(f,{children:[s(Y,{level:"h3",component:"h1",marginBottom:2,children:"\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 \u043C\u0430\u0433\u0430\u0437\u0438\u043D\u043E\u0432"}),s(f,{sx:{minWidth:670},children:s(Ve,{config:B,loading:!1,gap:2,children:ee(v,Fe,be(([o,D])=>{var b;return g(f,{children:[s(De,{variant:"soft",sx:{position:"sticky",top:48,marginTop:3,paddingX:1,paddingY:.5,zIndex:5,borderRadius:E=>E.radius.sm},children:s(Y,{fontSize:"large",fontWeight:"bold",textTransform:"capitalize",children:(b=i(o))==null?void 0:b.name})}),D.map(E=>s(je,{row:E},E.id))]},o)}))})}),s(_e,{}),s(Re,{onClick:()=>{e("create"),u(!0)}})]})};export{uu as default};
